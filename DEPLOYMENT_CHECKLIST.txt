â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… IMPLEMENTATION COMPLETE - Berita Cuaca Kekinian
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ 3-STEP DEPLOYMENT CHECKLIST:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1ï¸âƒ£  CREATE & CONFIGURE CACHE DIRECTORY
    mkdir -p cache/ && chmod 755 cache/

2ï¸âƒ£  SET NEWSAPI_KEY ENVIRONMENT VARIABLE
    export NEWSAPI_KEY="your_actual_newsapi_key_here"
    (Or use literal fallback in index.php for development)

3ï¸âƒ£  TEST & VERIFY DEPLOYMENT
    â€¢ First refresh cache: 
      http://localhost/tubes-kelompok-3/laman/berita-terbaru/?nocache=1&debug=1
    â€¢ Then view homepage:  
      http://localhost/tubes-kelompok-3/laman/berita-terbaru/

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” VERIFICATION SHELL COMMANDS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. Clear old cache
rm cache/news_weather.json

# 2. Fetch & populate cache with debug output (JSON)
curl -s "http://localhost/tubes-kelompok-3/laman/berita-terbaru/?nocache=1&debug=1" | jq

# 3. Verify cache file has full pool (not sliced)
jq '.totalResults, (.articles|length)' cache/news_weather.json

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ KEY FEATURES IMPLEMENTED:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Full article pool cached (NOT sliced to pageSizeDisplay)
âœ“ Pagination at render-time only (array_slice at render, not in cache)
âœ“ Kompas domain priority fetch (3 pages, 50 articles/page = 150 candidates)
âœ“ Global fallback with server-side Kompas filter (stripos on URL)
âœ“ URL deduplication & intelligent ranking (keywords first)
âœ“ ?nocache=1 to bypass cache and rebuild pool
âœ“ ?debug=1 to output raw JSON API response then exit
âœ“ ?page=N for server-side pagination
âœ“ Atomic cache writes (temp file + rename pattern)
âœ“ All output XSS-escaped (htmlspecialchars)
âœ“ Warning alerts on API errors & plan restrictions (HTTP 426)
âœ“ Responsive pagination UI styling (modern design)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš™ï¸  CONFIGURATION (top of index.php):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Easily adjustable parameters:
  â€¢ pageSizeDisplay = 10 (articles per UI page)
  â€¢ perRequest = 50 (articles per API call, max 100)
  â€¢ maxPagesKompas = 3 (max Kompas fetch pages)
  â€¢ maxPagesGlobal = 3 (max global search pages)
  â€¢ maxPool = 500 (max total articles in pool)
  â€¢ cacheTtl = 900 seconds (15 minutes)

Keywords used for prioritization:
  - cuaca, hujan, banjir, BMKG, peringatan cuaca, cuaca ekstrem

Global search query:
  - cuaca OR hujan OR banjir OR BMKG OR "cuaca ekstrem"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ FILES MODIFIED:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

index.php (~700 lines - complete rewrite)
  âœ“ Configuration block (API key, cache, pagination settings)
  âœ“ fetchFromApiRaw() - cURL wrapper with error handling
  âœ“ filterByKeywords() - server-side keyword filtering (limit param)
  âœ“ fetchRelevantArticles() - multi-step fetch strategy:
    1. Try Kompas domain (multi-page, no 'q')
    2. If error/insufficient, fallback to global search
    3. Filter for Kompas URLs if domain was blocked
    4. Deduplicate by URL
    5. Rank: keyword matches first, then fill remainder
    6. Return FULL pool (no pagination slicing)
  âœ“ Cache logic:
    - Skip if ?nocache=1
    - Load from cache if fresh (TTL check)
    - If no cache or stale, fetch from API
    - Save FULL pool to cache JSON (atomic write)
  âœ“ Debug mode (?debug=1 outputs JSON then exits)
  âœ“ Render-time pagination:
    - Load $articles = full pool from cache
    - Calculate $totalPages = ceil($totalArticles / $pageSizeDisplay)
    - Slice only: $pageArticles = array_slice($articles, offset, pageSizeDisplay)
    - Render only $pageArticles
  âœ“ HTML with full XSS escaping (htmlspecialchars all output)
  âœ“ Pagination UI with prev/next/page numbers

style.css (pagination styles added/verified)
  âœ“ .pagination - flex container for page controls
  âœ“ .page-link - standard button styling
  âœ“ .page-link-active - highlighted current page
  âœ“ .page-link-disabled - disabled state for nav buttons
  âœ“ .page-link-nav - prev/next button styling
  âœ“ .page-info - info box with border accent
  âœ“ .kompas-badge - red styling for Kompas articles
  âœ“ All using project color palette (#3667A6, #BDD8F1, #82A6CB, #214177)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¾ CACHE FILE STRUCTURE (news_weather.json):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{
  "status": "ok",
  "totalResults": <full pool count>,
  "articles": [
    { "title": "...", "url": "...", ... },  // Full pool, NOT paginated
    ...
  ],
  "warning": "..." or null,
  "fallback_used": true/false,
  "generated_at": "2025-12-06 12:34:56"
}

The "articles" array contains the ENTIRE pool collected from API,
not just pageSizeDisplay items. Pagination happens only at render time.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª ACCEPTANCE CRITERIA (AUTO-TESTED):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ After ?nocache=1&debug=1, JSON debug shows:
  - total_articles_fetched >= perRequest (or large pool)
  - articles array length >> pageSizeDisplay when available

âœ“ When running without params:
  - UI shows pageSizeDisplay articles per page
  - Pagination links shown when total > pageSizeDisplay
  - Current page clearly marked

âœ“ Cache file (cache/news_weather.json):
  - Stores full pool (testable via jq)
  - Not sliced to pageSizeDisplay

âœ“ Deduplication:
  - Same URL not shown twice
  - Enforced at pool collection stage

âœ“ Kompas fallback:
  - If domains=kompas.com returns HTTP 426 or domain error,
    code falls back to global fetch
  - Filters for Kompas URLs via stripos
  - Still builds large pool

âœ“ Warnings:
  - All error/warning conditions written to "warning" field
  - Displayed as alert on page
  - Preserved across cache loads

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Deployment ready! ğŸš€
